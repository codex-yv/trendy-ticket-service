<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://static.readdy.ai/static/e.js"></script>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Trendy Ticket Service - Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4f46e5',
                        secondary: '#06b6d4'
                    },
                    borderRadius: {
                        'none': '0px',
                        'sm': '4px',
                        DEFAULT: '8px',
                        'md': '12px',
                        'lg': '16px',
                        'xl': '20px',
                        '2xl': '24px',
                        '3xl': '32px',
                        'full': '9999px',
                        'button': '8px'
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="../static/style.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&amp;display=swap" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet" />
    <style>
        :where([class^="ri-"])::before {
            content: "\f3c2";
        }

        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }
        
        /* Attendee card styles */
        .attendee-card {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            background: white;
        }
        
        .attendee-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .attendee-details.expanded {
            max-height: 500px;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 9999px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-attended {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-not-attended {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .detail-label {
            font-weight: 500;
            color: #6b7280;
        }
        
        .detail-value {
            color: #374151;
        }
        
        /* Security section styles */
        .api-key-field {
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        
        .token-field {
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }
        
        .warning-modal {
            max-width: 400px;
        }
        
        /* Form validation styles */
        .form-input:invalid {
            border-color: #ef4444;
        }
        
        .form-input:valid {
            border-color: #10b981;
        }
        
        .required-field::after {
            content: " *";
            color: #ef4444;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            background: #10b981;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateX(120%);
            transition: transform 0.3s ease;
            z-index: 1001;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.error {
            background: #ef4444;
        }
        
        /* Loading spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            min-width: 200px;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <div class="px-6 pt-6">
        <nav class="bg-white/80 backdrop-blur-lg border border-white/20 rounded-2xl shadow-lg max-w-4xl mx-auto">
            <div class="px-8 py-4">
                <div class="flex items-center justify-between space-x-4">
                    <div class="flex items-center space-x-8">
                        <div class="font-['Pacifico'] text-xl text-primary">Trendy Ticket Service</div>
                        <div class="flex items-center space-x-6">
                            <button id="dashboard-button"
                                class="bg-primary text-white px-4 py-2 !rounded-button whitespace-nowrap flex items-center space-x-2">
                                <div class="w-4 h-4 flex items-center justify-center">
                                    <i class="ri-dashboard-line text-sm"></i>
                                </div>
                                <span class="text-sm font-medium">Dashboard</span>
                            </button>
                            <button id="events-button"
                                class="text-gray-600 hover:text-primary px-4 py-2 !rounded-button whitespace-nowrap flex items-center space-x-2 transition-colors">
                                <div class="w-4 h-4 flex items-center justify-center">
                                    <i class="ri-calendar-event-line text-sm"></i>
                                </div>
                                <span class="text-sm font-medium">Events</span>
                            </button>
                            <button id="security-button"
                                class="text-gray-600 hover:text-primary px-4 py-2 !rounded-button whitespace-nowrap flex items-center space-x-2 transition-colors">
                                <div class="w-4 h-4 flex items-center justify-center">
                                    <i class="ri-shield-line text-sm"></i>
                                </div>
                                <span class="text-sm font-medium">Security</span>
                            </button>
                            <button id="host-event-button"
                                class="bg-gradient-to-r from-secondary to-cyan-500 text-white px-4 py-2 !rounded-button whitespace-nowrap flex items-center space-x-2">
                                <div class="w-4 h-4 flex items-center justify-center">
                                    <i class="ri-add-circle-line text-sm"></i>
                                </div>
                                <span class="text-sm font-medium">Host Event</span>
                            </button>
                        </div>
                    </div>
                    <button id="logout-button"
                        class="text-gray-600 hover:bg-red-500 hover:text-white hover:font-bold px-4 py-2 !rounded-button whitespace-nowrap flex items-center space-x-2 transition-all duration-200">
                        <div class="w-4 h-4 flex items-center justify-center">
                            <i class="ri-logout-box-line text-sm"></i>
                        </div>
                        <span class="text-sm font-medium">Logout</span>
                    </button>
                </div>
            </div>
        </nav>
    </div>
    <main class="px-6 py-8">
        <div class="max-w-7xl mx-auto">
            <!-- Dashboard Section -->
            <div id="dashboard-section">
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Trendy Ticket Service - Admin Dashboard</h1>
                    <p class="text-gray-600">Welcome back! Here's what's happening with your events today.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-primary to-indigo-600 rounded-lg flex items-center justify-center">
                                <i class="ri-calendar-check-line text-white text-xl"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold text-gray-900" id="total-events">0</p>
                                <p class="text-sm text-gray-600">Total Events</p>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-1">Total Events Hosted</h3>
                        <p class="text-sm text-gray-600">All-time events created</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-secondary to-cyan-600 rounded-lg flex items-center justify-center">
                                <i class="ri-live-line text-white text-xl"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold text-gray-900" id="total-active-events">0</p>
                                <p class="text-sm text-gray-600">Currently Live</p>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-1">Total Active Events</h3>
                        <p class="text-sm text-gray-600">Events happening now</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-amber-400 to-orange-500 rounded-lg flex items-center justify-center">
                                <i class="ri-group-line text-white text-xl"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold text-gray-900" id="total-users">0</p>
                                <p class="text-sm text-gray-600">Total Users</p>
                            </div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-1">Total Users</h3>
                        <p class="text-sm text-gray-600">Registered users</p>
                    </div>
                </div>
                
                <!-- Recent Events Section (Only in Dashboard) -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-100">
                    <div class="p-6 border-b border-gray-100">
                        <div class="flex items-center justify-between">
                            <h2 class="text-xl font-semibold text-gray-900">Recent Events</h2>
                            <button
                                class="text-primary hover:text-indigo-700 text-sm font-medium flex items-center space-x-1">
                                <span>View All</span>
                                <div class="w-4 h-4 flex items-center justify-center">
                                    <i class="ri-arrow-right-line text-sm"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4" id="recent-events-list">
                            <!-- Recent events will be populated here by JavaScript -->
                            <div class="text-center py-8 text-gray-500">
                                <i class="ri-calendar-line text-4xl mb-2"></i>
                                <p>No recent events found</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Events Section -->
            <div id="events-section" class="bg-white rounded-xl shadow-sm border border-gray-100 mb-8" style="display: none;">
                <div class="p-6 border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-900">Events Management</h2>
                    </div>
                </div>
                <div class="p-6">
                    <!-- Tabs for Active and Inactive Events -->
                    <div class="flex space-x-1 mb-6">
                        <button id="active-events-tab" class="px-4 py-2 bg-primary text-white rounded-lg font-medium">Active Events</button>
                        <button id="inactive-events-tab" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium">Inactive Events</button>
                    </div>
                    
                    <!-- Active Events Content -->
                    <div id="active-events-content">
                        <div class="space-y-4" id="active-events-list">
                            <!-- Active events will be populated here by JavaScript -->
                            <div class="text-center py-8 text-gray-500">
                                <i class="ri-calendar-line text-4xl mb-2"></i>
                                <p>No active events found</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Inactive Events Content -->
                    <div id="inactive-events-content" class="hidden">
                        <div class="space-y-4" id="inactive-events-list">
                            <!-- Inactive events will be populated here by JavaScript -->
                            <div class="text-center py-8 text-gray-500">
                                <i class="ri-calendar-line text-4xl mb-2"></i>
                                <p>No inactive events found</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Security Section -->
            <div id="security-section" class="bg-white rounded-xl shadow-sm border border-gray-100 mb-8" style="display: none;">
                <div class="p-6 border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-900">Security Settings</h2>
                    </div>
                </div>
                <div class="p-6">
                    <!-- API Key Section -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">API Key</h3>
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                            <div class="flex items-center justify-between mb-3">
                                <label class="text-sm font-medium text-gray-700">Master API Key</label>
                                <div class="flex items-center space-x-2">
                                    <button id="toggle-api-key" class="text-gray-500 hover:text-gray-700">
                                        <i class="ri-eye-line"></i>
                                    </button>
                                    <button id="regenerate-api-key" class="text-gray-500 hover:text-red-500">
                                        <i class="ri-refresh-line"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="relative">
                                <input 
                                    type="password" 
                                    id="api-key-input"
                                    value=""
                                    readonly
                                    class="api-key-field w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-800 font-mono text-sm"
                                />
                            </div>
                            <p class="text-xs text-gray-500 mt-2">Use this key to authenticate API requests. Keep it secure and never share it publicly.</p>
                        </div>
                    </div>
                    
                    <!-- Event Tokens Section -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Event Tokens</h3>
                        <div id="event-tokens-list" class="space-y-4">
                            <!-- Event tokens will be populated here by JavaScript -->
                            <div class="text-center py-8 text-gray-500">
                                <i class="ri-key-line text-4xl mb-2"></i>
                                <p>No event tokens found</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Host Event Section -->
            <div id="host-event-section" class="bg-white rounded-xl shadow-sm border border-gray-100 mb-8" style="display: none;">
                <div class="p-6 border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-900">Host New Event</h2>
                    </div>
                </div>
                <div class="p-6">
                    <form id="host-event-form" class="space-y-6">
                        <!-- Event Name -->
                        <div>
                            <label for="event-name" class="block text-sm font-medium text-gray-700 mb-2 required-field">Event Name</label>
                            <input 
                                type="text" 
                                id="event-name" 
                                name="event-name"
                                required
                                class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                placeholder="Enter event name"
                            >
                        </div>
                        
                        <!-- Company Name -->
                        <div>
                            <label for="company-name" class="block text-sm font-medium text-gray-700 mb-2 required-field">Company Name</label>
                            <input 
                                type="text" 
                                id="company-name" 
                                name="company-name"
                                required
                                class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                placeholder="Enter company name"
                            >
                        </div>
                        
                        <!-- Event Location -->
                        <div>
                            <label for="event-location" class="block text-sm font-medium text-gray-700 mb-2 required-field">Event Location</label>
                            <input 
                                type="text" 
                                id="event-location" 
                                name="event-location"
                                required
                                class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                placeholder="Enter event location"
                            >
                        </div>
                        
                        <!-- Date Section -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Start Date -->
                            <div>
                                <label for="start-date" class="block text-sm font-medium text-gray-700 mb-2 required-field">Start Date</label>
                                <input 
                                    type="datetime-local" 
                                    id="start-date" 
                                    name="start-date"
                                    required
                                    class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                >
                            </div>
                            
                            <!-- End Date -->
                            <div>
                                <label for="end-date" class="block text-sm font-medium text-gray-700 mb-2 required-field">End Date</label>
                                <input 
                                    type="datetime-local" 
                                    id="end-date" 
                                    name="end-date"
                                    required
                                    class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                >
                            </div>
                        </div>

                        <!-- Ticket Cost -->
                        <div>
                            <label for="ticket-cost" class="block text-sm font-medium text-gray-700 mb-2 required-field">Ticket Cost</label>
                            <input 
                                type="number" 
                                id="ticket-cost" 
                                name="ticket-cost"
                                min="0"
                                step="0.01"
                                required
                                class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                placeholder="Enter ticket cost"
                            >
                        </div>
                        
                        <!-- Ticket Expiry Date -->
                        <div>
                            <label for="ticket-expiry-date" class="block text-sm font-medium text-gray-700 mb-2 required-field">Ticket Expiry Date</label>
                            <div class="space-y-3">
                                <input 
                                    type="datetime-local" 
                                    id="ticket-expiry-date" 
                                    name="ticket-expiry-date"
                                    required
                                    class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                >
                                <div class="flex items-center">
                                    <input 
                                        type="checkbox" 
                                        id="same-as-end-date"
                                        class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"
                                    >
                                    <label for="same-as-end-date" class="ml-2 text-sm text-gray-700">Same as end date</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Event Ticket Limit -->
                        <div>
                            <label for="ticket-limit" class="block text-sm font-medium text-gray-700 mb-2 required-field">Event Ticket Limit</label>
                            <input 
                                type="number" 
                                id="ticket-limit" 
                                name="ticket-limit"
                                min="1"
                                required
                                class="form-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                placeholder="Enter maximum number of tickets"
                            >
                        </div>
                        
                        <!-- Event Token -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Event Token</label>
                            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-sm font-medium text-gray-700">Auto-generated Event Token</span>
                                    <button type="button" id="copy-token" class="text-primary hover:text-indigo-700 flex items-center space-x-1">
                                        <i class="ri-clipboard-line"></i>
                                        <span class="text-sm">Copy</span>
                                    </button>
                                </div>
                                <div class="relative">
                                    <input 
                                        type="text" 
                                        id="event-token"
                                        value=""
                                        readonly
                                        class="token-field w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-800 font-mono text-sm"
                                    >
                                </div>
                                <p class="text-xs text-gray-500 mt-2">This token will be used to authenticate API requests for this specific event.</p>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex space-x-4 pt-6">
                            <button 
                                type="button" 
                                id="clear-form"
                                class="flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium"
                            >
                                Clear Form
                            </button>
                            <button 
                                type="submit"
                                id="host-event-submit"
                                class="flex-1 px-6 py-3 bg-gradient-to-r from-secondary to-cyan-500 text-white rounded-lg hover:from-cyan-600 hover:to-cyan-700 transition-colors font-medium"
                            >
                                Host Event
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="flex items-center space-x-2">
            <i class="ri-checkbox-circle-line"></i>
            <span id="toast-message">Operation completed successfully!</span>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner mx-auto mb-4"></div>
            <p class="text-gray-700 font-medium">Processing...</p>
        </div>
    </div>

    <!-- Attendees Modal -->
    <div id="attendees-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-gray-900" id="modal-title">Attendees List</h3>
                    <button id="close-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="ri-close-line text-2xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <!-- Filter Tabs -->
                <div class="flex space-x-2 mb-6">
                    <button class="filter-tab active px-4 py-2 bg-primary text-white rounded-lg font-medium" data-filter="all">All</button>
                    <button class="filter-tab px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium" data-filter="attended">Attended</button>
                    <button class="filter-tab px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium" data-filter="not-attended">Not Attended</button>
                </div>
                
                <!-- Attendees List -->
                <div id="attendees-list">
                    <!-- Attendees will be populated here by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Warning Modal for Regenerate API Key -->
    <div id="regenerate-warning-modal" class="modal-overlay">
        <div class="modal-content warning-modal">
            <div class="p-6">
                <div class="flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4">
                    <i class="ri-alert-line text-red-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 text-center mb-2">Regenerate API Key</h3>
                <p class="text-gray-600 text-center mb-6">Are you sure you want to regenerate your API key? This action cannot be undone and will invalidate the current key.</p>
                <div class="flex space-x-3">
                    <button id="cancel-regenerate" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
                    <button id="confirm-regenerate" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">Regenerate</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Warning Modal for Delete Token -->
    <div id="delete-token-modal" class="modal-overlay">
        <div class="modal-content warning-modal">
            <div class="p-6">
                <div class="flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4">
                    <i class="ri-alert-line text-red-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 text-center mb-2" id="delete-token-title">Delete Token</h3>
                <p class="text-gray-600 text-center mb-6" id="delete-token-message">Are you sure you want to delete this token? This action cannot be undone.</p>
                <div class="flex space-x-3">
                    <button id="cancel-delete" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
                    <button id="confirm-delete" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script id="navigation-interactions">
        document.addEventListener('DOMContentLoaded', function () {
            const navButtons = document.querySelectorAll('nav button');
            const dashboardButton = document.getElementById('dashboard-button');
            const eventsButton = document.getElementById('events-button');
            const securityButton = document.getElementById('security-button');
            const hostEventButton = document.getElementById('host-event-button');
            const logoutButton = document.getElementById('logout-button');
            const dashboardSection = document.getElementById('dashboard-section');
            const eventsSection = document.getElementById('events-section');
            const securitySection = document.getElementById('security-section');
            const hostEventSection = document.getElementById('host-event-section');
            const activeEventsTab = document.getElementById('active-events-tab');
            const inactiveEventsTab = document.getElementById('inactive-events-tab');
            const activeEventsContent = document.getElementById('active-events-content');
            const inactiveEventsContent = document.getElementById('inactive-events-content');
            
            // Dashboard elements
            const totalEventsElement = document.getElementById('total-events');
            const totalActiveEventsElement = document.getElementById('total-active-events');
            const totalUsersElement = document.getElementById('total-users');
            const recentEventsList = document.getElementById('recent-events-list');
            
            // Events elements
            const activeEventsList = document.getElementById('active-events-list');
            const inactiveEventsList = document.getElementById('inactive-events-list');
            
            // Security elements
            const apiKeyInput = document.getElementById('api-key-input');
            const eventTokensList = document.getElementById('event-tokens-list');
            
            // Host Event Form Elements
            const hostEventForm = document.getElementById('host-event-form');
            const eventTokenInput = document.getElementById('event-token');
            const copyTokenBtn = document.getElementById('copy-token');
            const clearFormBtn = document.getElementById('clear-form');
            const sameAsEndDateCheckbox = document.getElementById('same-as-end-date');
            const endDateInput = document.getElementById('end-date');
            const ticketExpiryDateInput = document.getElementById('ticket-expiry-date');
            const hostEventSubmitBtn = document.getElementById('host-event-submit');
            
            // Toast notification
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            // Loading overlay
            const loadingOverlay = document.getElementById('loading-overlay');
            
            // Modal elements
            const attendeesModal = document.getElementById('attendees-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const modalTitle = document.getElementById('modal-title');
            const attendeesList = document.getElementById('attendees-list');
            const filterTabs = document.querySelectorAll('.filter-tab');
            
            // Security section elements
            const toggleApiKeyBtn = document.getElementById('toggle-api-key');
            const regenerateApiKeyBtn = document.getElementById('regenerate-api-key');
            
            // Warning modals
            const regenerateWarningModal = document.getElementById('regenerate-warning-modal');
            const cancelRegenerateBtn = document.getElementById('cancel-regenerate');
            const confirmRegenerateBtn = document.getElementById('confirm-regenerate');
            
            const deleteTokenModal = document.getElementById('delete-token-modal');
            const cancelDeleteBtn = document.getElementById('cancel-delete');
            const confirmDeleteBtn = document.getElementById('confirm-delete');
            const deleteTokenTitle = document.getElementById('delete-token-title');
            const deleteTokenMessage = document.getElementById('delete-token-message');
            
            let currentTokenToDelete = null;
            let currentEventIdToDelete = null;
            let currentEventIdForAttendees = null;
            
            // Show dashboard section by default
            dashboardSection.style.display = 'block';
            eventsSection.style.display = 'none';
            securitySection.style.display = 'none';
            hostEventSection.style.display = 'none';
            
            // Load dashboard data on initial page load
            fetchDashboardData();
            
            // Dashboard button click handler
            dashboardButton.addEventListener('click', function() {
                dashboardSection.style.display = 'block';
                eventsSection.style.display = 'none';
                securitySection.style.display = 'none';
                hostEventSection.style.display = 'none';
                
                // Update nav button styles
                updateNavButtonStyles(this);
                
                // Fetch and update dashboard data
                fetchDashboardData();
            });
            
            // Events button click handler
            eventsButton.addEventListener('click', function() {
                eventsSection.style.display = 'block';
                dashboardSection.style.display = 'none';
                securitySection.style.display = 'none';
                hostEventSection.style.display = 'none';
                
                // Update nav button styles
                updateNavButtonStyles(this);
                
                // Fetch and update events data
                fetchEventsData();
            });
            
            // Security button click handler
            securityButton.addEventListener('click', function() {
                securitySection.style.display = 'block';
                dashboardSection.style.display = 'none';
                eventsSection.style.display = 'none';
                hostEventSection.style.display = 'none';
                
                // Update nav button styles
                updateNavButtonStyles(this);
                
                // Fetch and update security data
                fetchSecurityData();
            });
            
            // Host Event button click handler
            hostEventButton.addEventListener('click', function() {
                hostEventSection.style.display = 'block';
                dashboardSection.style.display = 'none';
                eventsSection.style.display = 'none';
                securitySection.style.display = 'none';
                
                // Update nav button styles
                updateNavButtonStyles(this);
                
                // Fetch event token from server
                fetchEventToken();
            });
            
            // Logout button click handler
            logoutButton.addEventListener('click', async function() {
                try {
                    // Show loading state
                    logoutButton.innerHTML = '<div class="spinner"></div><span class="text-sm font-medium">Logging out...</span>';
                    
                    // Send POST request to FastAPI server
                    const response = await fetch('/admin/ui/logout', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: 'logout_request'
                        }),
                        credentials: 'include' // Include cookies for session authentication
                    });
                    
                    // Handle redirect response
                    if (response.redirected) {
                        window.location.href = response.url;
                    } else if (response.status === 303) {
                        window.location.href = '/admin/login';
                    } else {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                } catch (error) {
                    console.error('Error during logout:', error);
                    // Restore logout button even on error
                    logoutButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-logout-box-line text-sm"></i></div><span class="text-sm font-medium">Logout</span>';
                    showToast('Failed to logout. Please try again.', true);
                }
            });
            
            // Helper function to update navigation button styles
            function updateNavButtonStyles(activeButton) {
                navButtons.forEach(btn => {
                    btn.classList.remove('bg-primary', 'text-white');
                    btn.classList.add('text-gray-600', 'hover:text-primary');
                });
                activeButton.classList.remove('text-gray-600', 'hover:text-primary');
                activeButton.classList.add('bg-primary', 'text-white');
            }
            
            // Function to fetch dashboard data from FastAPI server
            async function fetchDashboardData() {
                try {
                    // Show loading state
                    dashboardButton.innerHTML = '<div class="spinner"></div><span class="text-sm font-medium">Loading...</span>';
                    
                    // Send POST request to FastAPI server
                    const response = await fetch('/admin/ui/dashboard', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: 'dashboard_request'
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const adminData = await response.json();
                    
                    // Update dashboard with received data
                    updateDashboard(adminData);
                    
                    // Restore dashboard button
                    dashboardButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-dashboard-line text-sm"></i></div><span class="text-sm font-medium">Dashboard</span>';
                    
                } catch (error) {
                    console.error('Error fetching dashboard data:', error);
                    showToast('Failed to load dashboard data', true);
                    
                    // Restore dashboard button even on error
                    dashboardButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-dashboard-line text-sm"></i></div><span class="text-sm font-medium">Dashboard</span>';
                }
            }
            
            // Function to update dashboard with received data
            function updateDashboard(adminData) {
                // Update total events
                totalEventsElement.textContent = adminData.total_events || 0;
                
                // Update total active events
                totalActiveEventsElement.textContent = adminData.total_active_events || 0;
                
                // Update total users (assuming total_attendies is meant to be total_users)
                totalUsersElement.textContent = adminData.total_attendies || 0;
                
                // Update recent events
                updateRecentEvents(adminData.recent_events || []);
            }
            
            // Function to update recent events list
            function updateRecentEvents(recentEvents) {
                // Clear existing content
                recentEventsList.innerHTML = '';
                
                if (recentEvents.length === 0) {
                    recentEventsList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="ri-calendar-line text-4xl mb-2"></i>
                            <p>No recent events found</p>
                        </div>
                    `;
                    return;
                }
                
                // Add each recent event to the list
                recentEvents.forEach(event => {
                    const eventElement = document.createElement('div');
                    eventElement.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-100';
                    
                    eventElement.innerHTML = `
                        <div class="flex items-center space-x-4">
                            <div
                                class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                                <i class="ri-music-line text-white"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-900">${event[0]}</h3>
                                <div class="flex items-center space-x-4 text-sm text-gray-600 mt-1">
                                    <div class="flex items-center space-x-1">
                                        <div class="w-4 h-4 flex items-center justify-center">
                                            <i class="ri-user-line text-xs"></i>
                                        </div>
                                        <span>${event[2]} attendees</span>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-4 h-4 flex items-center justify-center">
                                            <i class="ri-calendar-line text-xs"></i>
                                        </div>
                                        <span>${event[1]}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span
                                class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-medium">Active</span>
                            <button class="text-gray-400 hover:text-gray-600">
                                <div class="w-5 h-5 flex items-center justify-center">
                                    <i class="ri-more-line"></i>
                                </div>
                            </button>
                        </div>
                    `;
                    
                    recentEventsList.appendChild(eventElement);
                });
            }
            
            // Function to fetch events data from FastAPI server
            async function fetchEventsData() {
                try {
                    // Show loading state
                    eventsButton.innerHTML = '<div class="spinner"></div><span class="text-sm font-medium">Loading...</span>';
                    
                    // Send POST request to FastAPI server
                    const response = await fetch('/admin/ui/events', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: 'events_request'
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const eventsData = await response.json();
                    
                    // Update events section with received data
                    updateEventsSection(eventsData);
                    
                    // Restore events button
                    eventsButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-calendar-event-line text-sm"></i></div><span class="text-sm font-medium">Events</span>';
                    
                } catch (error) {
                    console.error('Error fetching events data:', error);
                    showToast('Failed to load events data', true);
                    
                    // Restore events button even on error
                    eventsButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-calendar-event-line text-sm"></i></div><span class="text-sm font-medium">Events</span>';
                }
            }
            
            // Function to update events section with received data
            function updateEventsSection(eventsData) {
                // Clear existing content
                activeEventsList.innerHTML = '';
                inactiveEventsList.innerHTML = '';
                
                if (eventsData.length === 0) {
                    activeEventsList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="ri-calendar-line text-4xl mb-2"></i>
                            <p>No events found</p>
                        </div>
                    `;
                    inactiveEventsList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="ri-calendar-line text-4xl mb-2"></i>
                            <p>No events found</p>
                        </div>
                    `;
                    return;
                }
                
                // Process each event in the array
                eventsData.forEach(eventObj => {
                    // Extract event ID and event info from the object
                    const eventId = Object.keys(eventObj)[0];
                    const eventInfo = eventObj[eventId];
                    
                    const eventElement = document.createElement('div');
                    eventElement.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-100';
                    
                    // Determine status and styling
                    const isActive = eventInfo.status === true;
                    const statusClass = isActive ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800';
                    const statusText = isActive ? 'Active' : 'Inactive';
                    const iconGradient = isActive ? 'from-green-500 to-emerald-500' : 'from-gray-400 to-gray-600';
                    
                    eventElement.innerHTML = `
                        <div class="flex items-center space-x-4">
                            <div
                                class="w-10 h-10 bg-gradient-to-br ${iconGradient} rounded-lg flex items-center justify-center">
                                <i class="ri-music-line text-white"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-900">${eventInfo.event_name}</h3>
                                <div class="flex items-center space-x-4 text-sm text-gray-600 mt-1">
                                    <div class="flex items-center space-x-1">
                                        <div class="w-4 h-4 flex items-center justify-center">
                                            <i class="ri-ticket-line text-xs"></i>
                                        </div>
                                        <span>${eventInfo.total_tickets_sold} tickets sold</span>
                                    </div>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-4 h-4 flex items-center justify-center">
                                            <i class="ri-calendar-line text-xs"></i>
                                        </div>
                                        <span>${eventInfo.event_date}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="${statusClass} px-3 py-1 rounded-full text-xs font-medium">${statusText}</span>
                            <button class="view-attendees-btn bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors" data-event-id="${eventId}" data-event-name="${eventInfo.event_name}">
                                View Attendees
                            </button>
                        </div>
                    `;
                    
                    // Add to appropriate list based on status
                    if (isActive) {
                        activeEventsList.appendChild(eventElement);
                    } else {
                        inactiveEventsList.appendChild(eventElement);
                    }
                });
                
                // Add event listeners to view attendees buttons
                addViewAttendeesEventListeners();
            }
            
            // Function to add event listeners to view attendees buttons
            function addViewAttendeesEventListeners() {
                const viewAttendeesBtns = document.querySelectorAll('.view-attendees-btn');
                viewAttendeesBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const eventId = this.getAttribute('data-event-id');
                        const eventName = this.getAttribute('data-event-name');
                        currentEventIdForAttendees = eventId;
                        
                        modalTitle.textContent = `Attendees - ${eventName}`;
                        fetchAttendeesData(eventId);
                        attendeesModal.classList.add('active');
                    });
                });
            }
            
            // Function to fetch attendees data from FastAPI server
            async function fetchAttendeesData(eventId) {
                try {
                    // Show loading overlay
                    showLoadingOverlay();
                    
                    // Send POST request to FastAPI server
                    const response = await fetch('/admin/ui/events/attendees', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: eventId
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const attendeesData = await response.json();
                    
                    // Update attendees modal with received data
                    updateAttendeesModal(attendeesData);
                    
                    // Hide loading overlay
                    hideLoadingOverlay();
                    
                } catch (error) {
                    console.error('Error fetching attendees data:', error);
                    hideLoadingOverlay();
                    showToast('Failed to load attendees data', true);
                }
            }
            
            // Function to update attendees modal with received data
            function updateAttendeesModal(attendeesData) {
                // Clear existing content
                attendeesList.innerHTML = '';
                
                if (attendeesData.length === 0) {
                    attendeesList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="ri-user-line text-4xl mb-2"></i>
                            <p>No attendees found for this event</p>
                        </div>
                    `;
                    return;
                }
                
                // Add each attendee to the list
                attendeesData.forEach(attendee => {
                    const attendeeCard = document.createElement('div');
                    attendeeCard.className = 'attendee-card';
                    
                    // Determine if attended based on attending_time
                    const attended = attendee.attending_time && attendee.attending_time !== 'N/A';
                    attendeeCard.setAttribute('data-status', attended ? 'attended' : 'not-attended');
                    
                    attendeeCard.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="flex items-center space-x-4">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-900">${attendee.name}</h4>
                                        <p class="text-sm text-gray-600 mt-1">Ticket ID: ${attendee.ticket_id}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-lg font-bold text-primary">$${attendee.amount}</p>
                                        <span class="status-badge ${attended ? 'status-attended' : 'status-not-attended'}">
                                            ${attended ? 'Attended' : 'Not Attended'}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <button class="view-more-btn ml-4 text-primary hover:text-indigo-700 font-medium text-sm flex items-center space-x-1">
                                <span>View More</span>
                                <i class="ri-arrow-down-s-line"></i>
                            </button>
                        </div>
                        <div class="attendee-details mt-4">
                            <div class="space-y-2">
                                <div class="detail-row">
                                    <span class="detail-label">Email:</span>
                                    <span class="detail-value">${attendee.email}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Phone:</span>
                                    <span class="detail-value">${attendee.phone}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Ticket Amount:</span>
                                    <span class="detail-value font-semibold text-primary">$${attendee.amount}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Payment ID:</span>
                                    <span class="detail-value font-mono text-sm">${attendee.payment_id}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Payment Time:</span>
                                    <span class="detail-value">${attendee.payment_time}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Attending Time:</span>
                                    <span class="detail-value">${attendee.attending_time || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    attendeesList.appendChild(attendeeCard);
                    
                    // Add click event to view more button
                    const viewMoreBtn = attendeeCard.querySelector('.view-more-btn');
                    const detailsSection = attendeeCard.querySelector('.attendee-details');
                    
                    viewMoreBtn.addEventListener('click', function() {
                        const isExpanded = detailsSection.classList.contains('expanded');
                        
                        if (isExpanded) {
                            detailsSection.classList.remove('expanded');
                            this.innerHTML = '<span>View More</span><i class="ri-arrow-down-s-line"></i>';
                        } else {
                            detailsSection.classList.add('expanded');
                            this.innerHTML = '<span>View Less</span><i class="ri-arrow-up-s-line"></i>';
                        }
                    });
                });
            }
            
            // Function to fetch security data from FastAPI server
            async function fetchSecurityData() {
                try {
                    // Show loading state
                    securityButton.innerHTML = '<div class="spinner"></div><span class="text-sm font-medium">Loading...</span>';
                    
                    // Send POST request to FastAPI server
                    const response = await fetch('/admin/ui/security', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: 'security_request'
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const securityData = await response.json();
                    
                    // Update security section with received data
                    updateSecuritySection(securityData);
                    
                    // Restore security button
                    securityButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-shield-line text-sm"></i></div><span class="text-sm font-medium">Security</span>';
                    
                } catch (error) {
                    console.error('Error fetching security data:', error);
                    showToast('Failed to load security data', true);
                    
                    // Restore security button even on error
                    securityButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-shield-line text-sm"></i></div><span class="text-sm font-medium">Security</span>';
                }
            }
            
            // Function to update security section with received data
            function updateSecuritySection(securityData) {
                // Update API key
                apiKeyInput.value = securityData.key_id || '';
                
                // Update event tokens
                updateEventTokens(securityData.event_tokens || []);
            }
            
            // Function to update event tokens list
            function updateEventTokens(eventTokens) {
                // Clear existing content
                eventTokensList.innerHTML = '';
                
                if (eventTokens.length === 0) {
                    eventTokensList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="ri-key-line text-4xl mb-2"></i>
                            <p>No event tokens found</p>
                        </div>
                    `;
                    return;
                }
                
                // Add each event token to the list
                eventTokens.forEach((token, index) => {
                    const tokenElement = document.createElement('div');
                    tokenElement.className = 'bg-gray-50 rounded-lg p-4 border border-gray-200';
                    const tokenId = `token-${index}`;
                    
                    tokenElement.innerHTML = `
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-medium text-gray-900">${token[1]}</h4>
                            <div class="flex items-center space-x-2">
                                <button class="toggle-token text-gray-500 hover:text-gray-700" data-token="${tokenId}">
                                    <i class="ri-eye-line"></i>
                                </button>
                                <button class="delete-token text-gray-500 hover:text-red-500" data-event="${token[1]}" data-token="${tokenId}" data-event-id="${token[0]}">
                                    <i class="ri-delete-bin-line"></i>
                                </button>
                            </div>
                        </div>
                        <div class="relative">
                            <input 
                                type="password" 
                                id="${tokenId}"
                                value="${token[2]}"
                                readonly
                                class="token-field w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-800 font-mono text-sm"
                            />
                        </div>
                    `;
                    
                    eventTokensList.appendChild(tokenElement);
                });
                
                // Add event listeners to the new token elements
                addTokenEventListeners();
            }
            
            // Function to fetch event token from FastAPI server
            async function fetchEventToken() {
                try {
                    // Show loading state
                    hostEventButton.innerHTML = '<div class="spinner"></div><span class="text-sm font-medium">Loading...</span>';
                    
                    // Send POST request to FastAPI server
                    const response = await fetch('/admin/ui/host-event', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: 'host_event_request'
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const eventToken = await response.json();
                    
                    // Update event token input with received token
                    eventTokenInput.value = eventToken;
                    
                    // Restore host event button
                    hostEventButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-add-circle-line text-sm"></i></div><span class="text-sm font-medium">Host Event</span>';
                    
                } catch (error) {
                    console.error('Error fetching event token:', error);
                    showToast('Failed to load event token', true);
                    
                    // Restore host event button even on error
                    hostEventButton.innerHTML = '<div class="w-4 h-4 flex items-center justify-center"><i class="ri-add-circle-line text-sm"></i></div><span class="text-sm font-medium">Host Event</span>';
                }
            }
            
            // Function to add event listeners to token elements
            function addTokenEventListeners() {
                // Token toggle functionality
                const toggleTokenBtns = document.querySelectorAll('.toggle-token');
                toggleTokenBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const tokenId = this.getAttribute('data-token');
                        const tokenInput = document.getElementById(tokenId);
                        const isPassword = tokenInput.type === 'password';
                        tokenInput.type = isPassword ? 'text' : 'password';
                        this.innerHTML = isPassword ? '<i class="ri-eye-off-line"></i>' : '<i class="ri-eye-line"></i>';
                    });
                });
                
                // Delete token functionality
                const deleteTokenBtns = document.querySelectorAll('.delete-token');
                deleteTokenBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const eventName = this.getAttribute('data-event');
                        const tokenId = this.getAttribute('data-token');
                        const eventId = this.getAttribute('data-event-id');
                        currentTokenToDelete = tokenId;
                        currentEventIdToDelete = eventId;
                        
                        deleteTokenTitle.textContent = `Delete Token for ${eventName}`;
                        deleteTokenMessage.textContent = `Are you sure you want to delete the token for "${eventName}"? This action cannot be undone and will revoke access for this event.`;
                        deleteTokenModal.classList.add('active');
                    });
                });
            }
            
            // Function to show loading overlay
            function showLoadingOverlay() {
                loadingOverlay.classList.add('active');
            }
            
            // Function to hide loading overlay
            function hideLoadingOverlay() {
                loadingOverlay.classList.remove('active');
            }
            
            // Tab switching functionality
            activeEventsTab.addEventListener('click', function() {
                activeEventsTab.classList.add('bg-primary', 'text-white');
                activeEventsTab.classList.remove('text-gray-600', 'hover:bg-gray-100');
                inactiveEventsTab.classList.remove('bg-primary', 'text-white');
                inactiveEventsTab.classList.add('text-gray-600', 'hover:bg-gray-100');
                activeEventsContent.classList.remove('hidden');
                inactiveEventsContent.classList.add('hidden');
            });
            
            inactiveEventsTab.addEventListener('click', function() {
                inactiveEventsTab.classList.add('bg-primary', 'text-white');
                inactiveEventsTab.classList.remove('text-gray-600', 'hover:bg-gray-100');
                activeEventsTab.classList.remove('bg-primary', 'text-white');
                activeEventsTab.classList.add('text-gray-600', 'hover:bg-gray-100');
                inactiveEventsContent.classList.remove('hidden');
                activeEventsContent.classList.add('hidden');
            });
            
            // Host Event Form Functionality
            
            // Copy token to clipboard
            copyTokenBtn.addEventListener('click', function() {
                eventTokenInput.select();
                eventTokenInput.setSelectionRange(0, 99999); // For mobile devices
                
                navigator.clipboard.writeText(eventTokenInput.value).then(function() {
                    showToast('Event token copied to clipboard!');
                }).catch(function(err) {
                    console.error('Failed to copy token: ', err);
                    showToast('Failed to copy token', true);
                });
            });
            
            // Same as end date checkbox functionality
            sameAsEndDateCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    ticketExpiryDateInput.value = endDateInput.value;
                    ticketExpiryDateInput.disabled = true;
                } else {
                    ticketExpiryDateInput.disabled = false;
                }
            });
            
            // Update ticket expiry date when end date changes
            endDateInput.addEventListener('change', function() {
                if (sameAsEndDateCheckbox.checked) {
                    ticketExpiryDateInput.value = this.value;
                }
            });
            
            // Clear form functionality
            clearFormBtn.addEventListener('click', function() {
                hostEventForm.reset();
                fetchEventToken();
                ticketExpiryDateInput.disabled = false;
                showToast('Form cleared successfully!');
            });
            
            // Form submission
            hostEventForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Validate form
                if (!hostEventForm.checkValidity()) {
                    showToast('Please fill all required fields correctly', true);
                    return;
                }
                
                // Show loading overlay
                showLoadingOverlay();
                hostEventSubmitBtn.disabled = true;
                
                try {
                    // Get form data
                    const formData = new FormData(hostEventForm);
                    
                    // Convert all values to strings to match the backend model
                    const eventData = {
                        event_name: String(formData.get('event-name') || ''),
                        company_name: String(formData.get('company-name') || ''),
                        event_location: String(formData.get('event-location') || ''),
                        start_date: String(formData.get('start-date') || ''),
                        end_date: String(formData.get('end-date') || ''),
                        ticket_cost: String(formData.get('ticket-cost') || '0'),
                        expiry: String(formData.get('ticket-expiry-date') || ''),
                        ticket_limit: String(formData.get('ticket-limit') || '0'),
                        event_token: String(eventTokenInput.value || '')
                    };
                    
                    console.log('Sending event data:', eventData);
                    
                    // Send POST request to FastAPI server to host event
                    const response = await fetch('/admin/ui/host-event/host', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(eventData),
                        credentials: 'include' // Include cookies for session authentication
                    });
                    
                    if (!response.ok) {
                        // Check if it's a redirect response (303)
                        if (response.status === 303) {
                            window.location.href = '/admin/login';
                            return;
                        }
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const hostResult = await response.json();
                    
                    // Hide loading overlay
                    hideLoadingOverlay();
                    hostEventSubmitBtn.disabled = false;
                    
                    if (hostResult === true) {
                        // Show success message
                        showToast('Event hosted successfully! Redirecting to events...');
                        
                        // Reset form and redirect to events section after delay
                        setTimeout(() => {
                            hostEventForm.reset();
                            fetchEventToken();
                            eventsButton.click(); // Redirect to events section
                        }, 2000);
                    } else {
                        showToast('Failed to host event. Please try again.', true);
                    }
                    
                } catch (error) {
                    console.error('Error hosting event:', error);
                    hideLoadingOverlay();
                    hostEventSubmitBtn.disabled = false;
                    showToast('Failed to host event. Please try again.', true);
                }
            });
            
            // Toast notification function
            function showToast(message, isError = false) {
                toastMessage.textContent = message;
                toast.className = isError ? 'toast error show' : 'toast show';
                
                setTimeout(() => {
                    toast.className = isError ? 'toast error' : 'toast';
                }, 3000);
            }
            
            // Close modal functionality
            closeModalBtn.addEventListener('click', function() {
                attendeesModal.classList.remove('active');
            });
            
            // Close modal when clicking outside
            attendeesModal.addEventListener('click', function(e) {
                if (e.target === attendeesModal) {
                    attendeesModal.classList.remove('active');
                }
            });
            
            // Filter tabs functionality
            filterTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Update active tab
                    filterTabs.forEach(t => t.classList.remove('active', 'bg-primary', 'text-white'));
                    this.classList.add('active', 'bg-primary', 'text-white');
                    
                    const filter = this.getAttribute('data-filter');
                    filterAttendees(filter);
                });
            });
            
            // Function to filter attendees based on status
            function filterAttendees(filter) {
                const cards = attendeesList.querySelectorAll('.attendee-card');
                
                cards.forEach(card => {
                    if (filter === 'all') {
                        card.style.display = '';
                    } else {
                        const status = card.getAttribute('data-status');
                        card.style.display = status === filter ? '' : 'none';
                    }
                });
            }
            
            // API Key toggle functionality
            toggleApiKeyBtn.addEventListener('click', function() {
                const isPassword = apiKeyInput.type === 'password';
                apiKeyInput.type = isPassword ? 'text' : 'password';
                this.innerHTML = isPassword ? '<i class="ri-eye-off-line"></i>' : '<i class="ri-eye-line"></i>';
            });
            
            // Regenerate API Key functionality
            regenerateApiKeyBtn.addEventListener('click', function() {
                regenerateWarningModal.classList.add('active');
            });
            
            // Cancel regenerate
            cancelRegenerateBtn.addEventListener('click', function() {
                regenerateWarningModal.classList.remove('active');
            });
            
            // Confirm regenerate
            confirmRegenerateBtn.addEventListener('click', async function() {
                // Show loading overlay
                showLoadingOverlay();
                regenerateWarningModal.classList.remove('active');
                
                try {
                    // Send POST request to FastAPI server to regenerate API key
                    const response = await fetch('/admin/ui/security/api_key', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            x: 'regenerate_api_key'
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const newKey = await response.json();
                    
                    // Update API key input with the new key
                    apiKeyInput.value = newKey;
                    
                    // Hide loading overlay
                    hideLoadingOverlay();
                    
                    // Show success message
                    showToast('API key regenerated successfully!');
                    
                } catch (error) {
                    console.error('Error regenerating API key:', error);
                    hideLoadingOverlay();
                    showToast('Failed to regenerate API key', true);
                }
            });
            
            // Cancel delete token
            cancelDeleteBtn.addEventListener('click', function() {
                deleteTokenModal.classList.remove('active');
                currentTokenToDelete = null;
                currentEventIdToDelete = null;
            });
            
            // Confirm delete token
            confirmDeleteBtn.addEventListener('click', async function() {
                if (currentTokenToDelete && currentEventIdToDelete) {
                    // Show loading overlay
                    showLoadingOverlay();
                    deleteTokenModal.classList.remove('active');
                    
                    try {
                        // Send POST request to FastAPI server to delete token
                        const response = await fetch('/admin/ui/security/event_token', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                x: currentEventIdToDelete
                            })
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const deleteResult = await response.json();
                        
                        // Hide loading overlay
                        hideLoadingOverlay();
                        
                        if (deleteResult === true) {
                            // Remove the token element from the DOM
                            const tokenElement = document.querySelector(`[data-token="${currentTokenToDelete}"]`).closest('.bg-gray-50');
                            tokenElement.remove();
                            
                            // Show success message
                            showToast('Token deleted successfully!');
                            
                            // Refresh the security data to ensure consistency
                            fetchSecurityData();
                        } else {
                            showToast('Failed to delete token', true);
                        }
                        
                        currentTokenToDelete = null;
                        currentEventIdToDelete = null;
                        
                    } catch (error) {
                        console.error('Error deleting token:', error);
                        hideLoadingOverlay();
                        showToast('Failed to delete token', true);
                        currentTokenToDelete = null;
                        currentEventIdToDelete = null;
                    }
                }
            });
            
            // Close warning modals when clicking outside
            [regenerateWarningModal, deleteTokenModal].forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                        currentTokenToDelete = null;
                        currentEventIdToDelete = null;
                    }
                });
            });
        });
    </script>
    <script id="card-hover-effects">
        document.addEventListener('DOMContentLoaded', function () {
            const cards = document.querySelectorAll('.bg-white');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-2px)';
                    this.style.transition = 'transform 0.2s ease-in-out';
                });
                card.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
    </script>
    <script>
        !function (t, e) { var o, n, p, r; e.__SV || (window.posthog = e, e._i = [], e.init = function (i, s, a) { function g(t, e) { var o = e.split("."); 2 == o.length && (t = t[o[0]], e = o[1]), t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } } (p = t.createElement("script")).type = "text/javascript", p.crossOrigin = "anonymous", p.async = !0, p.src = s.api_host.replace(".i.posthog.com", "-assets.i.posthog.com") + "/static/array.js", (r = t.getElementsByTagName("script")[0]).parentNode.insertBefore(p, r); var u = e; for (void 0 !== a ? u = e[a] = [] : a = "posthog", u.people = u.people || [], u.toString = function (t) { var e = "posthog"; return "posthog" !== a && (e += "." + a), t || (e += " (stub)"), e }, u.people.toString = function () { return u.toString(1) + ".people (stub)" }, o = "init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "), n = 0; n < o.length; n++)g(u, o[n]); e._i.push([i, s, a]) }, e.__SV = 1) }(document, window.posthog || []);
        posthog.init('phc_t9tkQZJiyi2ps9zUYm8TDsL6qXo4YmZx0Ot5rBlAlEd', {
            api_host: 'https://us.i.posthog.com',
            autocapture: false,
            capture_pageview: false,
            capture_pageleave: false,
            capture_performance: {
                web_vitals: false,
            },
            rageclick: false,
        })
        window.shareKey = 'yp9DM_64IgipyQ_Uy5am_Q';
        window.host = 'readdy.ai';
    </script>
</body>

</html>